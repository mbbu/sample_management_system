1) Rename Columns in CSV to be the same as fields in the database. Convert file to CSV
- Renamed the following fields:
theme - theme_id
users - user_id
sa_description - description
sample_type - sample_type
loc_sample - location_collected
pi - project_owner
risk_level - security_level
location - destination

2) Create a temporary table in the database with all fields in the CSV file

CREATE TABLE redcapdata(record_id integer, redcap_event_name varchar(250), redcap_repeat_instrument varchar(250), redcap_repeat_instance integer, theme_id integer, animal_health integer, others_animal integer, health_human integer, other_animal integer, plant_health integer, others_plant integer, environmental_health integer, others_environmental integer, user_id integer, project_owner integer, sample_type integer, sample_others varchar(250), source_sample integer, others_samplesource varchar(250), security_level integer, bulk_samples integer,  cm_level integer, sample_description varchar(250) , location_collected varchar(250), freezer_location varchar(250), freezer_number integer, chamber_level integer,   rack_number integer, trays___1 integer, trays___2 integer, trays___3 integer, trays___4 integer, trays___5 integer, trays___6 integer, trays___7 integer, box_number integer, box_label varchar(250), sm1 integer, sm2 integer, sm3 integer, sm4 integer, sm5 integer, sm6 integer, sm7 integer, sm8 integer, sm9 integer, sm10 integer, date timestamp, sample_storage_complete integer, identifier_sample varchar(250), location varchar, sample_source  integer, other varchar(250), sample_type_collected integer, other_type_of_sample varchar(250), bio_safety integer, number_samples_collected integer, sample_data_complete integer, house_hold_id varchar(250), destinaion varchar(250), marital_status integer, employment varchar(250), number_of_people integer, number_child integer, academic___1 integer,academic___2 integer, academic___3 integer, academic___4 integer, academic___5 integer,academic___6 integer,academic___7 integer,academic___8 integer,academic___9 integer,academic___10 integer,number_animals integer, economic_activity varchar(250), type_of_crops integer, farming_activities integer,socialeconomicdata_complete integer);

3) Copy data from the CSV TO the temporary table

\COPY redcapdata (record_id, redcap_event_name, redcap_repeat_instrument, redcap_repeat_instance, theme_id , animal_health, others_animal , health_human , other_animal , plant_health , others_plant, environmental_health , others_environmental , user_id , project_owner , sample_type , sample_others , source_sample , others_samplesource , security_level , bulk_samples ,  cm_level , sample_description , location_collected , freezer_location , freezer_number , chamber_level,   rack_number , trays___1 , trays___2 , trays___3 , trays___4 , trays___5 , trays___6 , trays___7 , box_number , box_label , sm1 , sm2 , sm3 , sm4 , sm5 , sm6 , sm7 , sm8, sm9 , sm10, date, sample_storage_complete , identifier_sample , location , sample_source  , other , sample_type_collected, other_type_of_sample , bio_safety , number_samples_collected, sample_data_complete , house_hold_id , destinaion , marital_status, employment , number_of_people , number_child , academic___1,academic___2 , academic___3 , academic___4 , academic___5 , academic___6 , academic___7, academic___8 , academic___9 ,academic___10 , number_animals , economic_activity , type_of_crops , farming_activities ,socialeconomicdata_complete) FROM '/home/shiro/flask_applications/sample_management_system/extras/redcap_extract.csv' WITH (format csv);

4)  Insert data from the temporary table to the definitive table.

INSERT INTO sample (theme_id, user_id, sample_type, sample_description, location_collected, project_owner, security_level) SELECT theme_id, user_id, sample_type, sample_description, location_collected, project_owner, security_level FROM redcapdata ;



